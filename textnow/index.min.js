const formId="Bring-My-Phone-Form",successId="success",errorId="error",warningId="IMEI-error",buySimId="buy-sim",validateImei=a=>{if(a){const b=a.replace(/[\s-]+/g,"");if(!(/^[0-9a-fA-F]{8}$/.test(b)||/^[0-9]{11}$/.test(b)||/^[0-9]{14}$/.test(b)||/^[0-9a-fA-F]{14}$/.test(b)||/^[0-9]{15}$/.test(b)||/^[0-9a-fA-F]{15}$/.test(b)||/^[0-9]{18}$/.test(b)))return{status:!1,message:"Invalid IMEI/MEID/ESN"}}else return{status:!1,message:"You must enter an IMEI/MEID/ESN"};return{status:!0,message:"Success"}},removeWarning=()=>{document.getElementById(warningId)&&(document.getElementById(warningId).style.display="none")},onSuccess=a=>{removeWarning(),document.getElementById(formId).style.display="none",document.getElementById(errorId).style.display="none",document.getElementById(successId).style.display="block",document.querySelector(`#${successId} div.bring-my-phone-second-col`).scrollIntoView({block:"center",inline:"nearest",behavior:"smooth"}),document.getElementById(buySimId).setAttribute("href",a)},showWarning=a=>{let b=document.getElementById(warningId);b||(b=document.createElement("label"),b.setAttribute("id","IMEI-error"),b.setAttribute("for","IMEI"),b.classList.add("error"),document.getElementById("IMEI").after(b)),b.style.display="block",a&&(b.textContent=a)};window.addEventListener("load",()=>{window.scrollTo({top:0,left:0,behavior:"smooth"});const a=document.getElementById(formId),b=document.getElementById("IMEI");a.reset(),b.addEventListener("input",removeWarning),a.addEventListener("submit",a=>{a.preventDefault(),a.stopImmediatePropagation(),a.stopPropagation();const c=b.value,{status:d,message:e}=validateImei(c);if(d){const a=JSON.stringify({device_id:c});fetch(`https://${window.location.hostname}/api/wireless/byod/v2/validate`,{method:"POST",headers:{"Content-Type":"application/json","Content-Length":a.length},body:a}).then(a=>{if(500!==a.status)return a.json();throw new Error(a.statusText)}).then(a=>{const b=a.validation_result,c=a.error_code;if(b)switch(b){case"VALIDATION_SIM_REQUIRED":{onSuccess(`https://${window.location.hostname}/wireless/checkout?plan_id=0&product_id=${a.sim_product_id}`);break}case"VALIDATION_CANNOT_ACTIVATE":{showWarning("Sorry, this phone is not compatible.");break}}else if(c)switch(c){case"DEVICE_ID_INVALID":{showWarning("Invalid IMEI/MEID/ESN");break}case"DEVICE_NOT_SUPPORTED":{showWarning("Sorry, your phone isn't currently supported by TextNow");break}case"DEVICE_ID_REQUIRED":{showWarning("You must enter an IMEI/MEID/ESN");break}case"ICCID_INVALID":{showWarning("Invalid SIM Number / ICCID");break}default:{showWarning("Oops, something appears to be wrong. Please try again later.");break}}}).catch(a=>{console.error(a),showWarning("Oops, something appears to be wrong. Please try again later.")})}else showWarning(e)})});