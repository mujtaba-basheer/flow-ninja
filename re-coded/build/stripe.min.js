window.addEventListener("load",()=>{const a={payment_mode:"one-time",f_amount:20,c_amount:0,name:"",email:"",card_no:"",exp_date:"12/24",cvc:"",processing:!1},b=window.Cleave||{},c=window.Stripe||{},d=c("pk_live_Y2F8jxZI5xiM5j7Nx11DO0IZ"),e=document.getElementById("wf-form-Donate");if(e){e.reset();{const b=e.querySelectorAll("div.donate-small a"),c=b.item(0);c&&(c.classList.remove("button-variant-small"),c.classList.add("button-small")),b.forEach(c=>{c.addEventListener("click",d=>{var e;d.preventDefault();const f=null===(e=c.textContent)||void 0===e?void 0:e.trim().toLowerCase();a.payment_mode=f,b.forEach(a=>{a===c?(a.classList.remove("button-variant-small"),a.classList.add("button-small")):(a.classList.add("button-variant-small"),a.classList.remove("button-small"))})})})}{const b=e.querySelectorAll("div.donate-options-wrapper a"),c=b.item(0);c&&c.classList.add("active"),b.forEach(c=>{c.addEventListener("click",d=>{var f;d.preventDefault();const g=null===(f=c.textContent)||void 0===f?void 0:f.trim().replace("$","");b.forEach(b=>{if(b===c){const c=e.querySelector("input#custom-amount");if(b.classList.contains("active"))a.f_amount=0;else{if(a.f_amount=a.c_amount=+g,c){c.value=g;const a=c.nextElementSibling;a&&a.classList.add("hide")}b.classList.add("active")}}else b.classList.remove("active")})})})}{const b=e.querySelector("input#custom-amount");if(b){b.setAttribute("step","0.01");const c=b.nextElementSibling,d=e.querySelectorAll("div.donate-options-wrapper a");b.addEventListener("input",()=>{const e=b.value;if(/^([0-9]+(?:[\.][0-9]*)?|\.[0-9]+)$/.test(e)){const b=+e;.5<=b?(a.c_amount=b,c&&c.classList.add("hide"),d.forEach(a=>a.classList.remove("active"))):c&&(c.textContent="Amount should not be less than $0.50",c.classList.remove("hide"))}else b.value=e.replace(/\-/g,""),c&&(c.textContent="Please enter a valid positive number",c.classList.remove("hide"))})}}{const b=e.querySelector("input#name-on-card");b&&b.addEventListener("input",()=>{const c=b.value;a.name=c;const d=b.nextElementSibling;d&&(c?d.classList.add("hide"):(d.textContent="This field is required",d.classList.remove("hide")))})}{const b=e.querySelector("input#email");b&&b.addEventListener("input",()=>{const c=b.value;a.email=c;const d=b.nextElementSibling;if(d){/^[\w-\.]+@([\w-]+\.)+[\w-]+$/g.test(c)?d.classList.add("hide"):(d.classList.remove("hide"),d.textContent=c?"Please enter a valid email address.":"This field is required.")}})}{const d=e.querySelector("input#card-number");if(d){const f=d.nextElementSibling,g=new b(d,{creditCard:!0,onValueChanged:b=>{c(!1);const d=b.target.rawValue;a.card_no=d,f&&(d&&10<=d.length?f.classList.add("hide"):(f.textContent=d?"Please enter a valid card number.":"This field is required.",f.classList.remove("hide")))}})}}{const d=e.querySelector("input#mm-aa");if(d){const f=d.nextElementSibling,g=new b(d,{date:!0,datePattern:["m","y"],onValueChanged:b=>{c(!1);const d=b.target.rawValue;if(a.exp_date=d,f){/[0-9]{4}/g.test(d)?f.classList.add("hide"):(f.classList.remove("hide"),f.textContent=d?"Please enter a valid expiry date.":"This field is required.")}}})}}{const d=e.querySelector("input#cvc");if(d){d.setAttribute("maxlength","4"),d.setAttribute("minlength","3");const f=d.nextElementSibling,g=new b(d,{numericOnly:!0,blocks:[4],onValueChanged:b=>{c(!1);const d=b.target.rawValue;a.cvc=d,f&&(3<=d.length?f.classList.add("hide"):(f.textContent="Please enter a valid CVC code.",f.classList.remove("hide")))}})}}const c=(a,b)=>{const c=e.querySelector("div#error-div");if(c)if(!a)c.classList.add("hide");else{c.classList.remove("hide");const a=c.querySelector("div#error-text");a&&b&&(a.textContent=b)}};c(!1),e.addEventListener("submit",async b=>{b.preventDefault(),b.stopImmediatePropagation(),c(!1);const f=e.querySelector("input#submit");if(!a.processing){a.processing=!0,f&&(f.value="Processing...");const{c_amount:b,f_amount:e,email:g,card_no:h,cvc:i,exp_date:j,name:k}=a;try{let a=JSON.stringify({amount:100*(b||e),email:g});const c=await fetch("https://ktb4manlgh.execute-api.us-east-1.amazonaws.com/prod/payment-intent",{method:"POST",headers:{"Content-Type":"application/json","Content-Length":a.length+""},body:a}),f=await c.json();if(f.status){const{data:{clientSecret:a}}=f,b=j.substring(0,2),c=j.substring(2),e=JSON.stringify({number:h,cvc:i,exp_month:+b,exp_year:+`20${c}`,email:g,name:k}),l=await fetch("https://ktb4manlgh.execute-api.us-east-1.amazonaws.com/prod/payment-method",{method:"POST",headers:{"Content-Type":"application/json","Content-Length":e.length+""},body:e}),m=await l.json();if(m.status){const b=await d.confirmCardPayment(a,{payment_method:m.data.id},{handleActions:!0}),{paymentIntent:c,error:e}=b;if(c&&"succeeded"===c.status){const{amount:a,id:b}=c;window.location.href=`${window.location.protocol}//${window.location.hostname}/donate-thank-you?name=${encodeURIComponent(k)}&amount=${a/100}&ref=${encodeURIComponent(b)}`}else throw console.error(new Error(e.code)),new Error(e.message)}else throw new Error(m.message)}}catch(a){console.error(a),c(!0,a.message)}a.processing=!1,f&&(f.value="Donate")}})}});