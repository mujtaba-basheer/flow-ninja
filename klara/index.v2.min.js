const nftd=Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,currency:"USD"}),nftdInd=Intl.NumberFormat("en-IN",{minimumFractionDigits:3,maximumFractionDigits:3}),nftdInd1=Intl.NumberFormat("en-IN",{minimumFractionDigits:1,maximumFractionDigits:1}),getNum=(a,b)=>{const c=a.val();return""===c?b:"0"===c?0:+c},calculatePhoneTagCost=(a,b)=>{if(isNaN(+a)&&isNaN(+b))return!1;return 12*(20*(+a*(1-+b/100)*15*3))/60},calculateAbandonedCallsCost=(a,b)=>{if(isNaN(+a)&&isNaN(+b))return!1;return 12*(20*(+a*+b*.35*150))/100},calculateNoShowCost=(a,b)=>{if(isNaN(+a)&&isNaN(+b))return!1;return 12*(20*(+a*+b*150))/100},updateSavingsChart=({phone_tag_savings:a,abandoned_calls_savings:b,no_show_savings:d})=>{var e=Math.round;const f=[a,b,d],g=f.reduce((a,b)=>a+b,0);let h=0;const i=f.map(a=>(h+=360*(a/g),h)),j=f.map(a=>{return e(100*(a/g))});let[k,l]=i;$("#savings-pie-chart").css("background-image",`conic-gradient(white ${k}deg, #F4CECE 0 ${l}deg, #C69999 0)`),[k,l]=j,$("span.phone-tag").text(k),$("span.abandoned-calls").text(l),$("span.appointment-no-shows").text(e(100-k-l))},updateRoiChart=({net_profit:a,total_cost:b})=>{let c=100,d=100;b>a?c=a/b*d:d=b/a*c,$(".white-first").css("height",`${c}%`),$(".rose-first").css("height",`${d}%`),$(".first-year-savings").text("$"+nftd.format(a))},showTotalSavings=({phone_tag_cost:a,abandoned_calls_cost:b,no_show_cost:c})=>{$("#Charts").removeClass("opacity-30");const d=$("#Providers").val()&&+$("#Providers").val()||20;if(isNaN(+d))return;const e=.75*a,f=.3*b,g=.35*c,h=e+f+g,i=2400*d,j=h-i;let k=h/i,l=Math.round(100*k);$("#Savings").html("$"+nftd.format(h)),$("#savings-text").html("$"+nftd.format(h)),$("#net-profit").html("$"+nftd.format(j)),$("#net-profit-text").html("$"+nftd.format(j)),$("#annual-roi").html(nftd.format(l)+`%`),$("#roi-on-klara").html(nftdInd1.format(k)+`x`),updateSavingsChart({phone_tag_savings:e,abandoned_calls_savings:f,no_show_savings:g}),updateRoiChart({net_profit:j,total_cost:i})},validateForm=a=>{const b=document.getElementById(a).querySelectorAll("input");let c=!0;for(const d of b)if(!d.classList.contains("hidden")&&!d.checkValidity()){c=!1;break}return c},downloadPdf=async()=>{const a=(a,b=0)=>{let c=$(`#${a}`).val();return c=c?isNaN(+c)?b:+c:b,c},b=a=>nftd.format(a),c=a=>{const b=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return b.format(a)},d=a("Calls-make-per-day",400),e=a("Speaking-with-patient",30),f=a("Calls-receive-per-day",400),g=a("Abandoned-calls",10),h=a("Patients-seen-each-day",200),i=a("No-shows",20),j=calculatePhoneTagCost(d,e),k=calculateAbandonedCallsCost(f,g),l=calculateNoShowCost(h,i);const m=.75*j+.3*k+.35*l;let n=a("Providers",20),o=2400*n;const p=m-o,q=Math.round(100*(m/o)),r={outbound_calls_per_day:c(d),percent_of_connected_calls:c(e),inbound_calls_per_day:c(f),percent_of_calls_abandoned:c(g),appointments_per_day:c(h),percent_of_noshows:c(i),phone_tag_cost:b(j),abandoned_calls_cost:b(k),no_show_cost:b(l),total_savings_per_year:b(m),net_profit_first:b(p),percent_roi:c(q)+"%"};$("#roi-repport-download div.klara-button-text").text("Generating PDF...");const s=JSON.stringify({data:r,logo:!1});fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klata-roi-results",{method:"POST",headers:{"Content-Type":"application/json"},body:s}).then(a=>{if(200==a.status)return a.json();throw new Error(a.statusText)}).then(({data:{Location:a,Key:b}})=>{fetch(a,{method:"GET"}).then(a=>a.blob()).then(async a=>{$("#roi-repport-download div.klara-button-text").text("Download Results");const c=URL.createObjectURL(a),d=document.createElement("a");d.setAttribute("href",c),d.setAttribute("download","Klara ROI Results"),d.style.display="none",document.body.appendChild(d),d.click();try{const a=await fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klara-delete-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:b})});await a.json()}catch(a){console.error(a)}}).catch(a=>{console.error(a),$("#roi-repport-download div.klara-button-text").text("Download Results")})}).catch(a=>{console.error(a),$("#roi-repport-download div.klara-button-text").text("Download Results")})};window.addEventListener("load",function(){var a=Math.round;let b=!1,c=!1;{const a=window.location.search.substring(1),b=a.split("&");for(const a of b){let[b,c]=a.split("=");c=decodeURIComponent(c);const d=document.getElementById(b);d&&(d.value=c)}}{const a=$("#Providers"),b=$("#calculate-roi");a.on("input",function(){const a=$(this).val();a&&!isNaN(+a)?b.removeClass("disabled"):b.addClass("disabled")}),b.on("click",function(){$("#bottom-progress-bar").addClass("hidden"),$("#progress-bar-top").removeClass("hidden").removeClass("box-shadow-white"),$("#forms-calculator").removeClass("hidden"),$("#first-progress-dot").removeClass("disabled-progress-bar")})}const d=$("#see-your-roi"),e=()=>{let a=[!0,!0,!0];const b=[[$("#Calls-make-per-day").val(),$("#Speaking-with-patient").val()],[$("#Calls-receive-per-day").val(),$("#Abandoned-calls").val()],[$("#Patients-seen-each-day").val(),$("#No-shows").val()]];for(let c=0;c<b.length;c++){const d=b[c];for(const b of d)if(""===b||"0"===b){a[c]=!1;break}}const c=a[0]||a[1]||a[2];c?d.removeClass("disabled-button"):d.addClass("disabled-button")};{$("#roi-repport-download").on("click",function(a){a.preventDefault(),downloadPdf()});let b=400,c=30,d=400,f=10,g=200,h=20,i=50400,j=504e3,k=144e4;document.getElementById("num-of-providers").reset(),document.getElementById("wf-form-Forms-Calculator").reset(),document.getElementById("wf-form-ROI-Lead-Form").reset();{$("#Providers").on("input",()=>showTotalSavings({phone_tag_cost:i,abandoned_calls_cost:j,no_show_cost:k}));const d=()=>{let d=calculatePhoneTagCost(b,c);!1===d?$("#phone-tag-cost").text("NA"):(d=a(d),i=d,$("#phone-tag-cost").html("$"+nftd.format(d)),$("#phone-tag-cost").addClass("gray-900"),$("#result-div1").removeClass("border-grey-500"),e(),$("#card-result-1").removeClass("hidden"),0!==b||0!==c?$("#clear-button-1").removeClass("disabled"):$("#clear-button-1").addClass("disabled"),showTotalSavings({phone_tag_cost:i,abandoned_calls_cost:j,no_show_cost:k}))};$("#Calls-make-per-day").on("input",function(){b=getNum($(this),400),d()}),$("#Speaking-with-patient").on("input",function(){c=getNum($(this),30),d()}),$("#clear-button-1").on("click",function(){$("#Calls-make-per-day").val("0"),$("#Speaking-with-patient").val("0"),b=c=0,d(),$(this).addClass("disabled"),e(),$("#card-result-1").addClass("hidden")})}{const b=()=>{let b=calculateAbandonedCallsCost(d,f);!1===b?$("#abandoned-call-cost").text("NA"):(b=a(b),j=b,$("#abandoned-call-cost").html("$"+nftd.format(b)),$("#abandoned-call-cost").addClass("gray-900"),$("#result-div2").removeClass("border-grey-500"),e(),$("#clear-button-2").removeClass("disaled"),$("#card-result-2").removeClass("hidden"),d||f?$("#clear-button-2").removeClass("disabled"):$("#clear-button-2").addClass("disabled"),showTotalSavings({phone_tag_cost:i,abandoned_calls_cost:j,no_show_cost:k}))};$("#Calls-receive-per-day").on("input",function(){d=getNum($(this),400),b()}),$("#Abandoned-calls").on("input",function(){f=getNum($(this),10),b()}),$("#clear-button-2").on("click",function(){$("#Abandoned-calls").val("0"),$("#Calls-receive-per-day").val("0"),d=f=0,b(),$(this).addClass("disabled"),e(),$("#card-result-2").addClass("hidden")})}{const b=()=>{let b=calculateNoShowCost(g,h);!1===b?$("#no-show-cost").text("NA"):(b=a(b),k=b,$("#no-show-cost").html("$"+nftd.format(b)),$("#no-show-cost").addClass("gray-900"),$("#result-div3").removeClass("border-grey-500"),e(),$("#clear-button-3").removeClass("disaled"),$("#card-result-3").removeClass("hidden"),g||h?$("#clear-button-3").removeClass("disabled"):$("#clear-button-3").addClass("disabled"),showTotalSavings({phone_tag_cost:i,abandoned_calls_cost:j,no_show_cost:k}))};$("#Patients-seen-each-day").on("input",function(){g=getNum($(this),200),b()}),$("#No-shows").on("input",function(){h=getNum($(this),20),b()}),$("#clear-button-3").on("click",function(){$("#Patients-seen-each-day").val("0"),$("#No-shows").val("0"),g=h=0,b(),$(this).addClass("disabled"),e(),$("#card-result-3").addClass("hidden")})}}{const a=$("#wf-form-ROI-Lead-Form"),e=$("#roi-details-submit");d.on("click",function(){c||($("#form-gated").removeClass("hidden"),$("#second-progress-dot").removeClass("disabled-progress-bar"),$("#schedule-your-demo").removeClass("disabled"),$("#first-done-icon").addClass("show"),$("#first-progress-dot").addClass("show-icon"),$("#progres-line").addClass("half-full"),767>=$(window).width()&&setTimeout(()=>$("#open-form").trigger("click"),4e3))}),a.find("input").each(function(){$(this).on("input",function(){b=validateForm("wf-form-ROI-Lead-Form"),b?e.removeClass("disabled-button"):e.addClass("disabled-button")})}),e.on("click",function(){if(c)return;c=!0;let a="";a+=`Name: ${$("#First-Name-Details-Start").val()} ${$("#Last-Name-Details-Start").val()}\n\n`,a+=`Avg outbound calls made per day: ${$("#Calls-make-per-day").val()}\n`,a+=`% connected: ${$("#Speaking-with-patient").val()}\n`,a+=`Inbound patient calls per day: ${$("#Calls-receive-per-day").val()}\n`,a+=`Patient call abandonment: ${$("#Abandoned-calls").val()}\n`,a+=`Appts per day: ${$("#Patients-seen-each-day").val()}\n`,a+=`PNo show rate: ${$("#No-shows").val()}\n\n`,a+=`Phone Tag Cost: ${$("#phone-tag-cost").text()}\n`,a+=`Abandoned Calls Cost: ${$("#abandoned-call-cost").text()}\n`,a+=`Appointment No-Show Cost: ${$("#no-show-cost").text()}\n`,a+=`Total Cost Savings: ${$("#Savings").text()}\n`,a+=`ROI on Klara: ${$("#annual-roi").text()}\n`;const b={number_of_providers__c:$("#Providers").val(),FirstName:$("#First-Name-Details-Start").val(),LastName:$("#Last-Name-Details-Start").val(),Email:$("#Email-Details-Start").val(),Phone:$("#Phone-Details-Start").val(),Company:$("#Company-Details-Start").val(),EMR__c:$("#EMR-C").val(),Notes:a,Asset__c:$("#Asset__c").val(),Asset_Title__c:$("#Asset_Title__c").val(),gclid:$("#gclid").val(),utm_source:$("#utm_source").val(),utm_medium:$("#utm_medium").val(),utm_campaign:$("#utm_campaign").val(),utm_term:$("#utm_term").val()};d.attr("href","#charts-final"),$("#form-gated").addClass("hidden"),$("#charts-final").removeClass("hidden"),$("#small-section").removeClass("hidden"),$("#roi-footer").removeClass("hidden"),$("#second-progress-dot").addClass("show-icon"),$("#second-done-icon").addClass("show"),$("#third-progress-dot").removeClass("disabled-progress-bar"),$("#progres-line").addClass("completed-line"),ChiliPiper.submit("klara","roi_calculator",{lead:b,domElement:"#chilipiper-date-picker",injectRootCss:!0,title:"Schedule your consultation now",onSuccess:function(){$("#third-progress-dot").addClass("show-icon"),$("#third-done-icon").addClass("show"),setTimeout(()=>$("#chilipiper-date-picker").css("display","none"),7e3),setTimeout(()=>{let a="#successMessage1";767>=$(window).width()&&(a="#successMessage2"),$(a).removeClass("hidden").css("z-index","2")},8e3)}})})}{const a=new URL(document.URL),b=a.search&&a.search.substring(1);if(b){const a=new URLSearchParams(b),c=a.get("providers");$("#Providers").val(c),$("#Providers").trigger("input"),setTimeout(()=>$("#calculate-roi")[0].click(),1500)}}});