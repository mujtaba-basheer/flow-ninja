const nftd=Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,currency:"USD"}),calculatePhoneTagCost=(a,b)=>{if(isNaN(+a)&&isNaN(+b))return!1;return 12*(20*(+a*(1-+b/100)*15*3))/60},calculateAbandonedCallsCost=(a,b)=>{if(isNaN(+a)&&isNaN(+b))return!1;return 12*(20*(+a*+b*.35*150))/100},calculateNoShowCost=(a,b)=>{if(isNaN(+a)&&isNaN(+b))return!1;return 12*(20*(+a*+b*150))/100},updateSavingsChart=({phone_tag_savings:a,abandoned_calls_savings:b,no_show_savings:d})=>{var e=Math.round;const f=[a,b,d],g=f.reduce((a,b)=>a+b,0);let h=0;const i=f.map(a=>(h+=360*(a/g),h)),j=f.map(a=>{return e(100*(a/g))});let[k,l]=i;$("#savings-pie-chart").css("background-image",`conic-gradient(white ${k}deg, #F4CECE 0 ${l}deg, #C69999 0)`),[k,l]=j,$("span.phone-tag").text(k),$("span.abandoned-calls").text(l),$("span.appointment-no-shows").text(e(100-k-l))},updateRoiChart=({net_profit:a,total_cost:b})=>{let c=100,d=100;b>a?c=a/b*d:d=b/a*c,$(".white-third").css("height",`${c}%`),$(".rose-third").css("height",`${d}%`),$(".third-year-savings").text(": $"+nftd.format(3*a));const e=c/3,f=d/3;$(".white-first").css("height",`${e}%`),$(".rose-first").css("height",`${f}%`),$(".first-year-savings").text("$"+nftd.format(a))},showTotalSavings=({phone_tag_cost:a,abandoned_calls_cost:b,no_show_cost:c})=>{$("#Charts").removeClass("opacity-30"),$("#show-your-roi").removeClass("disabled-button");const d=$("#Providers").val()&&+$("#Providers").val()||20;if(isNaN(+d))return;const e=.75*a,f=.3*b,g=.35*c,h=e+f+g,i=2400*d;let j=h/i;j=Math.round(j),$("#Savings").html("$"+nftd.format(h)+`<span class="h3-style">/year</span>`),$("#annual-roi").html(j+`%`),updateSavingsChart({phone_tag_savings:e,abandoned_calls_savings:f,no_show_savings:g}),updateRoiChart({net_profit:h-i,total_cost:i})},downloadPdf=async a=>{a.preventDefault();const b=(a,b=0)=>{let c=$(`#${a}`).val();return c=c?isNaN(+c)?b:+c:b,c},c=a=>nftd.format(a),d=a=>{const b=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return b.format(a)},e=b("Calls-make-per-day",400),f=b("Speaking-with-patient",30),g=b("Calls-receive-per-day",400),h=b("Abandoned-calls",10),i=b("Patients-seen-each-day",200),j=b("No-shows",20),k=calculatePhoneTagCost(e,f),l=calculateAbandonedCallsCost(g,h),m=calculateNoShowCost(i,j);const n=.75*k+.3*l+.35*m;let o=b("Providers",20),p=2400*o;const q=n-p,r=c(n/p)+"%",s={outbound_calls_per_day:d(e),percent_of_connected_calls:d(f),inbound_calls_per_day:d(g),percent_of_calls_abandoned:d(h),appointments_per_day:d(i),percent_of_noshows:d(j),phone_tag_cost:c(k),abandoned_calls_cost:c(l),no_show_cost:c(m),total_savings_per_year:c(n),net_profit_first:c(q),net_profit_three:c(3*q),percent_roi:r};$("#roi-repport-download div:not(.download-icon)").text("Generating PDF...");const t=JSON.stringify({data:s,logo:!1});fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klata-roi-results",{method:"POST",headers:{"Content-Type":"application/json"},body:t}).then(a=>{if(200==a.status)return a.json();throw new Error(a.statusText)}).then(({data:{Location:a,Key:b}})=>{fetch(a,{method:"GET"}).then(a=>a.blob()).then(async a=>{$("#roi-repport-download div:not(.download-icon)").text("Download Results");const c=URL.createObjectURL(a),d=document.createElement("a");d.setAttribute("href",c),d.setAttribute("download","Klara ROI Results"),d.style.display="none",document.body.appendChild(d),d.click();try{const a=await fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klara-delete-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:b})});await a.json()}catch(a){console.error(a)}}).catch(a=>{console.error(a),$("#roi-repport-download div:not(.download-icon)").text("Download Results")})}).catch(a=>{console.error(a),$("#roi-repport-download div:not(.download-icon)").text("Download Results")})};window.addEventListener("load",()=>{var a=Math.round;document.getElementById("email-form-2").reset(),$("#roi-repport-download").on("click",downloadPdf);let b=400,c=30,d=400,e=10,f=200,g=20,h=50400,i=144e4,j=288e4;const k=`<span class="h3-style">/year</span>`;{$("#Providers").on("input",()=>showTotalSavings({phone_tag_cost:h,abandoned_calls_cost:i,no_show_cost:j}));const d=()=>{let d=calculatePhoneTagCost(b,c);d?(d=a(d),h=d,$("#phone-tag-cost").html("$"+nftd.format(d)+k),$("#phone-tag-cost").addClass("gray-900"),$("#result-div1").removeClass("border-grey-500"),showTotalSavings({phone_tag_cost:h,abandoned_calls_cost:i,no_show_cost:j})):$("#phone-tag-cost").text("NA")};$("#Calls-make-per-day").on("input",function(){b=$(this).val()||400,d()}),$("#Speaking-with-patient").on("input",function(){c=$(this).val()||30,d()})}{const b=()=>{let b=calculateAbandonedCallsCost(d,e);b?(b=a(b),i=b,$("#abandoned-call-cost").html("$"+nftd.format(b)+k),$("#abandoned-call-cost").addClass("gray-900"),$("#result-div2").removeClass("border-grey-500"),showTotalSavings({phone_tag_cost:h,abandoned_calls_cost:i,no_show_cost:j})):$("#abandoned-call-cost").text("NA")};$("#Calls-receive-per-day").on("input",function(){d=$(this).val()||400,b()}),$("#Abandoned-calls").on("input",function(){e=$(this).val()||10,b()})}{const b=()=>{let b=calculateNoShowCost(f,g);b?(b=a(b),j=b,$("#no-show-cost").html("$"+nftd.format(b)+k),$("#no-show-cost").addClass("gray-900"),$("#result-div3").removeClass("border-grey-500"),showTotalSavings({phone_tag_cost:h,abandoned_calls_cost:i,no_show_cost:j})):$("#no-show-cost").text("NA")};$("#Patients-seen-each-day").on("input",function(){f=$(this).val()||200,b()}),$("#No-shows").on("input",function(){g=$(this).val()||20,b()})}});