const nftd=Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,currency:"USD"}),nftdInd=Intl.NumberFormat("en-IN",{minimumFractionDigits:3,maximumFractionDigits:3}),nftdInd1=Intl.NumberFormat("en-IN",{minimumFractionDigits:1,maximumFractionDigits:1}),getNum=(a,b)=>{const c=a.val();return""===c?b:"0"===c?0:+c},calculatePhoneTagCost=(a,b,c,d)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c)&&isNaN(+d))return!1;return 12*(20*(+a*(1-+b)*d*c))/60},calculateAbandonedCallsCost=(a,b,c,d)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c)&&isNaN(+d))return!1;return 12*(20*(+a*+b*c*d))},calculateNoShowCost=(a,b,c)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c))return!1;return 12*(20*(+a*+b*c))},updateSavingsChart=({phone_tag_savings:a,abandoned_calls_savings:b,no_show_savings:d})=>{var e=Math.round;const f=[a,b,d],g=f.reduce((a,b)=>a+b,0);let h=0;const i=f.map(a=>(h+=360*(a/g),h)),j=f.map(a=>{return e(100*(a/g))});let[k,l]=i;$("#savings-pie-chart").css("background-image",`conic-gradient(white ${k}deg, #F4CECE 0 ${l}deg, #C69999 0)`),[k,l]=j,$("span.phone-tag").text(k),$("span.Abandoned-Calls").text(l),$("span.appointment-No-Shows").text(e(100-k-l))},updateRoiChart=({net_profit:a,total_cost:b})=>{let c=100,d=100;b>a?c=a/b*d:d=b/a*c,$(".first-year .white-bar").css("height",`${c}%`),$(".first-year .rose-chart").css("height",`${d}%`),$(".first-year-savings").text("$"+nftd.format(a))};let percent_phone_tag_savings=.75,percent_abandoned_calls_savings=.3,percent_no_show_savings=.35,outbound_calls_per_day=400,calls_connected=.3,inbound_calls_per_day=400,calls_abandoned=.1,appts_per_day=200,no_shows=.2,phone_tag_cost=50400,abandoned_calls_cost=504e3,no_show_cost=144e4,time_per_call=3,hourly_wage_calling=15,percent_calls_scheduling=.1,rev_per_appt=150;const showTotalSavings=({phone_tag_cost:a,abandoned_calls_cost:b,no_show_cost:c})=>{$("#Charts").removeClass("opacity-30");const d=$("#Providers").val()&&+$("#Providers").val()||20;if(isNaN(+d))return;const e=a*percent_phone_tag_savings,f=b*percent_abandoned_calls_savings,g=c*percent_no_show_savings,h=e+f+g,i=2400*d,j=h-i;let k=h/i,l=Math.round(100*k);$("#Savings").html("$"+nftd.format(h)),$("#savings-text").html("$"+nftd.format(h)),$("#net-profit").html("$"+nftd.format(j)),$("#net-profit-text").html("$"+nftd.format(j)),$("#annual-roi").html(nftd.format(l)+`%`),$("#roi-on-klara").html(nftdInd1.format(k)+`x`),updateSavingsChart({phone_tag_savings:e,abandoned_calls_savings:f,no_show_savings:g}),updateRoiChart({net_profit:j,total_cost:i})},validateForm=a=>{const b=document.getElementById(a).querySelectorAll("input");let c=!0;for(const d of b)if(!d.classList.contains("hidden")&&!d.checkValidity()){c=!1;break}return c},downloadPdf=async()=>{const a=(a,b=0)=>{let c=$(`#${a}`).val();return c=c?isNaN(+c)?b:+c:b,c},b=a=>nftd.format(a),c=a=>{const b=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return b.format(a)},d=a("Calls-Make-Per-Day",400),e=a("Speaking-With-Patient",30)/100,f=a("Calls-Receive-Per-Day",400),g=a("Abandoned-Calls",10)/100,h=a("Patients-Seen-Each-Day",200),i=a("No-Shows",20)/100,j=calculatePhoneTagCost(d,e,time_per_call,hourly_wage_calling),k=calculateAbandonedCallsCost(f,g,percent_calls_scheduling,rev_per_appt),l=calculateNoShowCost(h,i,rev_per_appt);let m=j*percent_phone_tag_savings,n=k*percent_abandoned_calls_savings,o=l*percent_no_show_savings;const p=m+n+o;let q=a("Providers",20),r=2400*q;const s=Math.round(100*(p/r)),t={outbound_calls_per_day:c(d),percent_of_connected_calls:c(e),inbound_calls_per_day:c(f),percent_of_calls_abandoned:c(g),appointments_per_day:c(h),percent_of_noshows:c(i),phone_tag_cost:b(j),abandoned_calls_cost:b(k),no_show_cost:b(l),total_savings_per_year:b(p),net_profit_first:b(p-r),percent_roi:c(s)+"%"};$("#roi-repport-download div.klara-button-text").text("Generating PDF...");const u=JSON.stringify({data:t,logo:!1});fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klata-roi-results",{method:"POST",headers:{"Content-Type":"application/json"},body:u}).then(a=>{if(200==a.status)return a.json();throw new Error(a.statusText)}).then(({data:{Location:a,Key:b}})=>{fetch(a,{method:"GET"}).then(a=>a.blob()).then(async a=>{$("#roi-repport-download div.klara-button-text").text("Download Results");const c=URL.createObjectURL(a),d=document.createElement("a");d.setAttribute("href",c),d.setAttribute("download","Klara ROI Results"),d.style.display="none",document.body.appendChild(d),d.click();try{const a=await fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klara-delete-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:b})});await a.json()}catch(a){console.error(a)}}).catch(a=>{console.error(a),$("#roi-repport-download div.klara-button-text").text("Download Results")})}).catch(a=>{console.error(a),$("#roi-repport-download div.klara-button-text").text("Download Results")})};window.addEventListener("load",function(){var a=Math.round;{const a=window.location.search.substring(1),b=a.split("&");for(const a of b){let[b,c]=a.split("=");c=decodeURIComponent(c);const d=document.getElementById(b);d&&(d.value=c)}}{const a=$("#Providers"),b=$("#calculate-roi");a.on("input",function(){const a=$(this).val();a&&!isNaN(+a)?b.removeClass("disabled"):b.addClass("disabled")}),b.on("click",function(){$("#bottom-progress-bar").addClass("hidden"),$("#progress-bar-top").removeClass("hidden").removeClass("box-shadow-white"),$("#forms-calculator").removeClass("hidden"),$("#first-progress-dot").removeClass("disabled-progress-bar")})}const b=$("#see-your-roi"),c=()=>{let a=[!0,!0,!0];const c=[[$("#Calls-Make-Per-Day").val(),$("#Speaking-With-Patient").val()],[$("#Calls-Receive-Per-Day").val(),$("#Abandoned-Calls").val()],[$("#Patients-Seen-Each-Day").val(),$("#No-Shows").val()]];for(let b=0;b<c.length;b++){const d=c[b];for(const c of d)if(""===c||"0"===c){a[b]=!1;break}}const d=a[0]||a[1]||a[2];d?b.removeClass("disabled-button"):b.addClass("disabled-button")};{$("#roi-repport-download").on("click",function(a){a.preventDefault(),downloadPdf()}),document.getElementById("num-of-providers").reset(),document.getElementById("roi-calc-form").reset();{$("#Providers").on("input",()=>showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}));const b=()=>{let b=calculatePhoneTagCost(outbound_calls_per_day,calls_connected,time_per_call,hourly_wage_calling);!1===b?($("#phone-tag-cost").text("NA"),$("#costOfPhone").text("NA")):(b=a(b),phone_tag_cost=b,$("#phone-tag-cost").html("$"+nftd.format(b)),$("#costOfPhone").html("$"+nftd.format(b)),$("#phone-tag-cost").addClass("gray-900"),$("#result-div1").removeClass("border-grey-500"),c(),$("#card-result-1").removeClass("hidden"),0!==outbound_calls_per_day||0!==calls_connected?$("#clear-button-1").removeClass("disabled"):$("#clear-button-1").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))};$("#Calls-Make-Per-Day").on("input",function(){outbound_calls_per_day=getNum($(this),400),b()}),$("#Speaking-With-Patient").on("input",function(){calls_connected=getNum($(this),30)/100,b()}),$("#Avg-Time-Per-Call").on("input",function(){time_per_call=getNum($(this),3),b()}),$("#hourlyWage").on("input",function(){hourly_wage_calling=getNum($(this),3),b()}),$("#clear-button-1").on("click",function(){$("#Calls-Make-Per-Day").val("0"),$("#Speaking-With-Patient").val("0"),outbound_calls_per_day=calls_connected=0,b(),$(this).addClass("disabled"),c(),$("#card-result-1").addClass("hidden")});const d=()=>{let b=calculateAbandonedCallsCost(inbound_calls_per_day,calls_abandoned,percent_calls_scheduling,rev_per_appt);!1===b?($("#abandoned-call-cost").text("NA"),$("#CostAbandoned").text("NA")):(b=a(b),abandoned_calls_cost=b,$("#abandoned-call-cost").html("$"+nftd.format(b)),$("#CostAbandoned").html("$"+nftd.format(b)),$("#abandoned-call-cost").addClass("gray-900"),$("#result-div2").removeClass("border-grey-500"),c(),$("#clear-button-2").removeClass("disaled"),$("#card-result-2").removeClass("hidden"),inbound_calls_per_day||calls_abandoned?$("#clear-button-2").removeClass("disabled"):$("#clear-button-2").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))};$("#Calls-Receive-Per-Day").on("input",function(){inbound_calls_per_day=getNum($(this),400),d()}),$("#Abandoned-Calls").on("input",function(){calls_abandoned=getNum($(this),10)/100,d()}),$("#Percentage-Scheduling").on("input",function(){percent_calls_scheduling=getNum($(this),35)/100,d()}),$("#revenue").on("input",function(){rev_per_appt=getNum($(this),150),d(),e()}),$("#clear-button-2").on("click",function(){$("#Abandoned-Calls").val("0"),$("#Calls-Receive-Per-Day").val("0"),inbound_calls_per_day=calls_abandoned=0,d(),$(this).addClass("disabled"),c(),$("#card-result-2").addClass("hidden")});const e=()=>{let b=calculateNoShowCost(appts_per_day,no_shows,rev_per_appt);!1===b?($("#no-show-cost").text("NA"),$("#costNoShows").text("NA")):(b=a(b),no_show_cost=b,$("#no-show-cost").html("$"+nftd.format(b)),$("#costNoShows").html("$"+nftd.format(b)),$("#no-show-cost").addClass("gray-900"),$("#result-div3").removeClass("border-grey-500"),c(),$("#clear-button-3").removeClass("disaled"),$("#card-result-3").removeClass("hidden"),appts_per_day||no_shows?$("#clear-button-3").removeClass("disabled"):$("#clear-button-3").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))};$("#Patients-Seen-Each-Day").on("input",function(){appts_per_day=getNum($(this),200),e()}),$("#No-Shows").on("input",function(){no_shows=getNum($(this),20)/100,e()}),$("#clear-button-3").on("click",function(){$("#Patients-Seen-Each-Day").val("0"),$("#No-Shows").val("0"),appts_per_day=no_shows=0,e(),$(this).addClass("disabled"),c(),$("#card-result-3").addClass("hidden")})}}$("#phoneTag").on("input",function(){percent_phone_tag_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#abandonedCalls").on("input",function(){percent_abandoned_calls_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#noShows").on("input",function(){percent_no_show_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#savingsButton").on("click",function(){$("#charts-section").removeClass("hidden")});{const a=new URL(document.URL),b=a.search&&a.search.substring(1);if(b){const a=new URLSearchParams(b),c=a.get("providers");$("#Providers").val(c),$("#Providers").trigger("input"),setTimeout(()=>$("#calculate-roi")[0].click(),1500)}}});