const nftd=Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,currency:"USD"}),nftdInd=Intl.NumberFormat("en-IN",{minimumFractionDigits:3,maximumFractionDigits:3}),nftdInd1=Intl.NumberFormat("en-IN",{minimumFractionDigits:1,maximumFractionDigits:1}),getNum=a=>{const b=a.val();return""===b?0:"0"===b?0:+b},calculatePhoneTagCost=(a,b,c,d)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c)&&isNaN(+d))return!1;return 12*(20*(+a*(1-+b)*d*c))/60},calculateAbandonedCallsCost=(a,b,c,d)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c)&&isNaN(+d))return!1;return 12*(20*(+a*+b*c*d))},calculateNoShowCost=(a,b,c)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c))return!1;return 12*(20*(+a*+b*c))},updateSavingsChart=({phone_tag_savings:a,abandoned_calls_savings:b,no_show_savings:d})=>{var e=Math.round;const f=[a,b,d],g=f.reduce((a,b)=>a+b,0);let h=0;const i=f.map(a=>(h+=360*(a/g),h)),j=f.map(a=>{return e(100*(a/g))});let[k,l]=i;$("#savings-pie-chart").css("background-image",`conic-gradient(#f2ecff ${k}deg, #b39cf7 0 ${l}deg, #625be1 0)`),[k,l]=j,$("span.phone-tag").text(k),$("span.abandoned-calls").text(l),$("span.appointment-no-shows").text(e(100-k-l))},updateRoiChart=({net_profit:a,total_cost:b})=>{console.log({net_profit:a,total_cost:b});let c=100,d=100;b>a?c=a/b*d:d=b/a*c,$(".first-year .white-bar").css("height",`${c}%`),$(".first-year .rose-chart").css("height",`${d}%`),$(".first-year-savings").text("$"+nftd.format(a))};let no_of_providers=null,rev_per_appt=null,percent_phone_tag_savings=0,percent_abandoned_calls_savings=0,percent_no_show_savings=0,outbound_calls_per_day=null,calls_connected=null,inbound_calls_per_day=null,calls_abandoned=null,percent_calls_scheduling=null,appts_per_day=null,no_shows=null,phone_tag_cost=null,abandoned_calls_cost=null,no_show_cost=null,time_per_call=null,hourly_wage_calling=null;const showTotalSavings=({phone_tag_cost:a,abandoned_calls_cost:b,no_show_cost:c})=>{$("#Charts").removeClass("opacity-30");if(isNaN(+no_of_providers))return;const d=a*percent_phone_tag_savings,e=b*percent_abandoned_calls_savings,f=c*percent_no_show_savings,g=d+e+f,h=2400*no_of_providers,i=g-h;let j=g/h,k=Math.round(100*j);$("#Savings").html("$"+nftd.format(g)),$("#savings-text").html("$"+nftd.format(g)),$("#net-profit").html("$"+nftd.format(i)),$("#net-profit-text").html("$"+nftd.format(i)),$("#annual-roi").html(nftd.format(k)+`%`),$("#roi-on-klara").html(nftdInd1.format(j)+`x`),updateSavingsChart({phone_tag_savings:d,abandoned_calls_savings:e,no_show_savings:f}),updateRoiChart({net_profit:i,total_cost:h})},updatePhoneTagCost=()=>{let a=calculatePhoneTagCost(outbound_calls_per_day,calls_connected,time_per_call,hourly_wage_calling);!1===a?$("#costOfPhone").text("NA"):(a=Math.round(a),phone_tag_cost=a,$("#costOfPhone").html("$"+nftd.format(a)),$("#result-div1").removeClass("border-grey-500"),checkRoiBtn(),$("#card-result-1").removeClass("hidden"),0!==outbound_calls_per_day||0!==calls_connected?$("#clear-button-1").removeClass("disabled"):$("#clear-button-1").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))},updateAbandonedCallsCost=()=>{let a=calculateAbandonedCallsCost(inbound_calls_per_day,calls_abandoned,percent_calls_scheduling,rev_per_appt);!1===a?$("#CostAbandoned").text("NA"):(a=Math.round(a),abandoned_calls_cost=a,$("#CostAbandoned").html("$"+nftd.format(a)),$("#result-div2").removeClass("border-grey-500"),checkRoiBtn(),$("#clear-button-2").removeClass("disaled"),$("#card-result-2").removeClass("hidden"),inbound_calls_per_day||calls_abandoned?$("#clear-button-2").removeClass("disabled"):$("#clear-button-2").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))},updateNoShowCost=()=>{let a=calculateNoShowCost(appts_per_day,no_shows,rev_per_appt);!1===a?$("#costNoShows").text("NA"):(a=Math.round(a),no_show_cost=a,$("#costNoShows").html("$"+nftd.format(a)),$("#result-div3").removeClass("border-grey-500"),checkRoiBtn(),$("#clear-button-3").removeClass("disaled"),$("#card-result-3").removeClass("hidden"),appts_per_day||no_shows?$("#clear-button-3").removeClass("disabled"):$("#clear-button-3").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))},checkRoiBtn=()=>{let a=[!0,!0,!0];const b=[[$("#Calls-Make-Per-Day").val(),$("#Speaking-With-Patient").val(),$("#Avg-Time-Per-Call").val(),$("#hourlyWage").val()],[$("#Calls-Receive-Per-Day").val(),$("#Calls-Receive-Per-Day").val(),$("#Percentage-Scheduling").val()],[$("#Patients-Seen-Each-Day").val(),$("#No-Shows").val()]];for(let c=0;c<b.length;c++){const d=b[c];for(const b of d)if(""===b||"0"===b){a[c]=!1;break}}const c=a[0]||a[1]||a[2];c?$("#see-your-roi").removeClass("disabled-button"):$("#see-your-roi").addClass("disabled-button")},validateForm=a=>{const b=document.getElementById(a).querySelectorAll("input");let c=!0;for(const d of b)if(!d.classList.contains("hidden")&&!d.checkValidity()){c=!1;break}return c},downloadPdf=async()=>{const a=a=>nftd.format(a),b=a=>{const b=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return b.format(a)};let c=phone_tag_cost*percent_phone_tag_savings,d=abandoned_calls_cost*percent_abandoned_calls_savings,e=no_show_cost*percent_no_show_savings;const f=c+d+e;let g=((a,b=0)=>{let c=$(`#${a}`).val();return c=c?isNaN(+c)?b:+c:b,c})("Providers",20),h=2400*g;const i=Math.round(100*(f/h)),j={no_of_providers:b(g),outbound_calls_per_day:b(outbound_calls_per_day),percent_of_connected_calls:b(100*calls_connected)+"%",average_call_length:`${b(time_per_call)} min`,hourly_staff_wage:`$${a(hourly_wage_calling)}`,inbound_calls_per_day:b(inbound_calls_per_day),percent_of_calls_abandoned:b(100*calls_abandoned)+"%",percent_of_scheduling_calls:b(100*percent_calls_scheduling)+"%",appointments_per_day:b(appts_per_day),percent_of_noshows:b(100*no_shows)+"%",avg_appt_rev:`$${a(rev_per_appt)}`,phone_tag_cost:`$${a(phone_tag_cost)}`,abandoned_calls_cost:`$${a(abandoned_calls_cost)}`,no_show_cost:`$${a(no_show_cost)}`,phone_tag_reduction:b(100*percent_phone_tag_savings)+"%",abandoned_call_reduction:b(100*percent_abandoned_calls_savings)+"%",no_show_reduction:b(100*percent_no_show_savings)+"%",total_savings_per_year:`$${a(f)}`,net_profit_first:`$${a(f-h)}`,percent_roi:b(i)+"%"};$("#roi-repport-download div:not(:first-child)").text("Generating PDF...");const k=JSON.stringify({data:j,logo:!1});fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klata-roi-results",{method:"POST",headers:{"Content-Type":"application/json"},body:k}).then(a=>{if(200==a.status)return a.json();throw new Error(a.statusText)}).then(({data:{Location:a,Key:b}})=>{fetch(a,{method:"GET"}).then(a=>a.blob()).then(async a=>{$("#roi-repport-download div:not(:first-child)").text("Download Results");const c=URL.createObjectURL(a),d=document.createElement("a");d.setAttribute("href",c),d.setAttribute("download","Klara ROI Results"),d.style.display="none",document.body.appendChild(d),d.click(),$("#third-progress-dot").addClass("show-icon"),$("#third-done-icon").addClass("show");try{const a=await fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klara-delete-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:b})});await a.json()}catch(a){console.error(a)}}).catch(a=>{console.error(a),$("#roi-repport-download div:not(:first-child)").text("Download Results")})}).catch(a=>{console.error(a),$("#roi-repport-download div:not(:first-child)").text("Download Results")})};window.addEventListener("load",function(){{const a=window.location.search.substring(1),b=a.split("&");for(const a of b){let[b,c]=a.split("=");c=decodeURIComponent(c);const d=document.getElementById(b);d&&(d.value=c)}}{const a=$("#Providers"),b=$("#revenue");goBtn=$("#calculate-roi");const c=()=>{no_of_providers&&!isNaN(+no_of_providers)&&rev_per_appt&&!isNaN(rev_per_appt)?goBtn.removeClass("disabled-button"):goBtn.addClass("disabled-button")};a.on("input",function(){no_of_providers=getNum(a,null),c()}),b.on("input",function(){rev_per_appt=getNum(b,null),updateAbandonedCallsCost(),updateNoShowCost(),c()}),goBtn.on("click",function(){$("#bottom-progress-bar").addClass("hidden"),$("#progress-bar-top").removeClass("hidden").removeClass("box-shadow-white"),$("#Card-Section").removeClass("hidden"),$("#first-progress-dot").removeClass("disabled-progress-bar")})}const a=$("#see-your-roi");a.on("click",function(){$("#sliderSection").removeClass("hidden"),$("#specifyKlaraAverages").removeClass("disabled"),$("#first-progress-dot").addClass("show-icon"),$("#first-done-icon").addClass("show"),$("#progres-line").addClass("half-full"),$("#second-progress-dot").removeClass("disabled-progress-bar")}),$("#roi-repport-download").on("click",function(a){a.preventDefault(),$("#second-progress-dot").addClass("show-icon"),$("#second-done-icon").addClass("show"),$("#progres-line").addClass("completed-line"),$("#third-progress-dot").removeClass("disabled-progress-bar"),downloadPdf()}),document.getElementById("wf-form-Email-Form-3").reset(),document.getElementById("roi-calc-form").reset(),$("#Providers").on("input",()=>showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})),$("#Calls-Make-Per-Day").on("input",function(){outbound_calls_per_day=getNum($(this),400),updatePhoneTagCost()}),$("#Speaking-With-Patient").on("input",function(){calls_connected=getNum($(this),30)/100,updatePhoneTagCost()}),$("#Avg-Time-Per-Call").on("input",function(){time_per_call=getNum($(this),3),updatePhoneTagCost()}),$("#hourlyWage").on("input",function(){hourly_wage_calling=getNum($(this),3),updatePhoneTagCost()}),$("#clear-button-1").on("click",function(){$("#Calls-Make-Per-Day").val("0"),$("#Speaking-With-Patient").val("0"),outbound_calls_per_day=calls_connected=0,updatePhoneTagCost(),$(this).addClass("disabled"),checkRoiBtn(),$("#card-result-1").addClass("hidden")}),$("#Calls-Receive-Per-Day").on("input",function(){inbound_calls_per_day=getNum($(this),400),updateAbandonedCallsCost()}),$("#Abandoned-Calls").on("input",function(){calls_abandoned=getNum($(this),10)/100,updateAbandonedCallsCost()}),$("#Percentage-Scheduling").on("input",function(){percent_calls_scheduling=getNum($(this),35)/100,updateAbandonedCallsCost()}),$("#clear-button-2").on("click",function(){$("#Abandoned-Calls").val("0"),$("#Calls-Receive-Per-Day").val("0"),inbound_calls_per_day=calls_abandoned=0,updateAbandonedCallsCost(),$(this).addClass("disabled"),checkRoiBtn(),$("#card-result-2").addClass("hidden")}),$("#Patients-Seen-Each-Day").on("input",function(){appts_per_day=getNum($(this),200),updateNoShowCost()}),$("#No-Shows").on("input",function(){no_shows=getNum($(this),20)/100,updateNoShowCost()}),$("#clear-button-3").on("click",function(){$("#Patients-Seen-Each-Day").val("0"),$("#No-Shows").val("0"),appts_per_day=no_shows=0,updateNoShowCost(),$(this).addClass("disabled"),checkRoiBtn(),$("#card-result-3").addClass("hidden")}),$("#phoneTag").on("input",function(){percent_phone_tag_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#abandonedCalls").on("input",function(){percent_abandoned_calls_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#noShows").on("input",function(){percent_no_show_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#savingsButton").on("click",function(){$("#charts-section").removeClass("hidden"),$("#roi-footer").removeClass("hidden"),$("#download-result").removeClass("disabled"),$("#second-progress-dot").addClass("show-icon"),$("#second-done-icon").addClass("show"),$("#progres-line").addClass("completed-line"),$("#third-progress-dot").removeClass("disabled-progress-bar")});{const a=new URL(document.URL),b=a.search&&a.search.substring(1);if(b){const a=new URLSearchParams(b),c=a.get("providers");$("#Providers").val(c),$("#Providers").trigger("input"),setTimeout(()=>$("#calculate-roi")[0].click(),1500)}}});