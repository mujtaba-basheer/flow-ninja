const nftd=Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0,currency:"USD"}),nftdInd=Intl.NumberFormat("en-IN",{minimumFractionDigits:3,maximumFractionDigits:3}),nftdInd1=Intl.NumberFormat("en-IN",{minimumFractionDigits:1,maximumFractionDigits:1}),getNum=a=>{const b=a.val();return""===b?0:"0"===b?0:+b},calculatePhoneTagCost=(a,b,c,d)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c)&&isNaN(+d))return!1;return 12*(20*(+a*(1-+b)*d*c))/60},calculateAbandonedCallsCost=(a,b,c,d)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c)&&isNaN(+d))return!1;return 12*(20*(+a*+b*c*d))},calculateNoShowCost=(a,b,c)=>{if(isNaN(+a)&&isNaN(+b)&&isNaN(+c))return!1;return 12*(20*(+a*+b*c))},updateSavingsChart=({phone_tag_savings:a,abandoned_calls_savings:b,no_show_savings:d})=>{var e=Math.round;const f=[a,b,d],g=f.reduce((a,b)=>a+b,0);let h=0;const i=f.map(a=>(h+=360*(a/g),h)),j=f.map(a=>{return e(100*(a/g))});let[k,l]=i;$("#savings-pie-chart").css("background-image",`conic-gradient(#f2ecff ${k}deg, #b39cf7 0 ${l}deg, #625be1 0)`),[k,l]=j,$("span.phone-tag").text(k),$("span.abandoned-calls").text(l),$("span.appointment-no-shows").text(e(100-k-l))},updateRoiChart=({net_profit:a,total_cost:b})=>{let c=100,d=100;b>a?c=a/b*d:d=b/a*c,$(".first-year .white-bar").css("height",`${c}%`),$(".first-year .rose-chart").css("height",`${d}%`),$(".first-year-savings").text("$"+nftd.format(a))};let percent_phone_tag_savings=0,percent_abandoned_calls_savings=0,percent_no_show_savings=0,outbound_calls_per_day=null,calls_connected=null,inbound_calls_per_day=null,calls_abandoned=null,appts_per_day=null,no_shows=null,phone_tag_cost=null,abandoned_calls_cost=null,no_show_cost=null,time_per_call=null,hourly_wage_calling=null,percent_calls_scheduling=null,rev_per_appt=null;const showTotalSavings=({phone_tag_cost:a,abandoned_calls_cost:b,no_show_cost:c})=>{$("#Charts").removeClass("opacity-30");const d=$("#Providers").val()&&+$("#Providers").val()||20;if(isNaN(+d))return;const e=a*percent_phone_tag_savings,f=b*percent_abandoned_calls_savings,g=c*percent_no_show_savings,h=e+f+g,i=2400*d,j=h-i;let k=h/i,l=Math.round(100*k);$("#Savings").html("$"+nftd.format(h)),$("#savings-text").html("$"+nftd.format(h)),$("#net-profit").html("$"+nftd.format(j)),$("#net-profit-text").html("$"+nftd.format(j)),$("#annual-roi").html(nftd.format(l)+`%`),$("#roi-on-klara").html(nftdInd1.format(k)+`x`),updateSavingsChart({phone_tag_savings:e,abandoned_calls_savings:f,no_show_savings:g}),updateRoiChart({net_profit:j,total_cost:i})},validateForm=a=>{const b=document.getElementById(a).querySelectorAll("input");let c=!0;for(const d of b)if(!d.classList.contains("hidden")&&!d.checkValidity()){c=!1;break}return c},downloadPdf=async()=>{const a=a=>nftd.format(a),b=a=>{const b=new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return b.format(a)};let c=phone_tag_cost*percent_phone_tag_savings,d=abandoned_calls_cost*percent_abandoned_calls_savings,e=no_show_cost*percent_no_show_savings;const f=c+d+e;let g=((a,b=0)=>{let c=$(`#${a}`).val();return c=c?isNaN(+c)?b:+c:b,c})("Providers",20),h=2400*g;const i=Math.round(100*(f/h)),j={no_of_providers:b(g),outbound_calls_per_day:b(outbound_calls_per_day),percent_of_connected_calls:b(100*calls_connected)+"%",average_call_length:`${b(time_per_call)} min`,hourly_staff_wage:`$${a(hourly_wage_calling)}`,inbound_calls_per_day:b(inbound_calls_per_day),percent_of_calls_abandoned:b(100*calls_abandoned)+"%",percent_of_scheduling_calls:b(100*percent_calls_scheduling)+"%",appointments_per_day:b(appts_per_day),percent_of_noshows:b(100*no_shows)+"%",avg_appt_rev:`$${a(rev_per_appt)}`,phone_tag_cost:`$${a(phone_tag_cost)}`,abandoned_calls_cost:`$${a(abandoned_calls_cost)}`,no_show_cost:`$${a(no_show_cost)}`,phone_tag_reduction:b(100*percent_phone_tag_savings)+"%",abandoned_call_reduction:b(100*percent_abandoned_calls_savings)+"%",no_show_reduction:b(100*percent_no_show_savings)+"%",total_savings_per_year:`$${a(f)}`,net_profit_first:`$${a(f-h)}`,percent_roi:b(i)+"%"};$("#roi-repport-download div:not(:first-child)").text("Generating PDF...");const k=JSON.stringify({data:j,logo:!1});fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klata-roi-results",{method:"POST",headers:{"Content-Type":"application/json"},body:k}).then(a=>{if(200==a.status)return a.json();throw new Error(a.statusText)}).then(({data:{Location:a,Key:b}})=>{fetch(a,{method:"GET"}).then(a=>a.blob()).then(async a=>{$("#roi-repport-download div:not(:first-child)").text("Download Results");const c=URL.createObjectURL(a),d=document.createElement("a");d.setAttribute("href",c),d.setAttribute("download","Klara ROI Results"),d.style.display="none",document.body.appendChild(d),d.click(),$("#third-progress-dot").addClass("show-icon"),$("#third-done-icon").addClass("show");try{const a=await fetch("https://5w7wjn195l.execute-api.us-east-1.amazonaws.com/prod/klara-delete-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:b})});await a.json()}catch(a){console.error(a)}}).catch(a=>{console.error(a),$("#roi-repport-download div:not(:first-child)").text("Download Results")})}).catch(a=>{console.error(a),$("#roi-repport-download div:not(:first-child)").text("Download Results")})};window.addEventListener("load",function(){var a=Math.round;$("#first-progress-dot").removeClass("disabled-progress-bar");{const a=window.location.search.substring(1),b=a.split("&");for(const a of b){let[b,c]=a.split("=");c=decodeURIComponent(c);const d=document.getElementById(b);d&&(d.value=c)}}{const a=$("#Providers"),b=$("#calculate-roi");a.on("input",function(){const a=$(this).val();a&&!isNaN(+a)?b.removeClass("disabled-button"):b.addClass("disabled-button")}),b.on("click",function(){$("#bottom-progress-bar").addClass("hidden"),$("#progress-bar-top").removeClass("hidden").removeClass("box-shadow-white"),$("#Card-Section").removeClass("hidden"),$("#first-progress-dot").removeClass("disabled-progress-bar")})}const b=$("#see-your-roi"),c=()=>{let a=!0;const c=[$("#Calls-Make-Per-Day").val(),$("#Speaking-With-Patient").val(),$("#Calls-Receive-Per-Day").val(),$("#Abandoned-Calls").val(),$("#Patients-Seen-Each-Day").val(),$("#No-Shows").val(),$("#Avg-Time-Per-Call").val(),$("#hourlyWage").val(),$("#Percentage-Scheduling").val(),$("#revenue").val()];for(let b=0;b<c.length;b++){const d=c[b];if(""===d||"0"===d){a=!1;break}}a?b.removeClass("disabled-button"):b.addClass("disabled-button")};b.on("click",function(){$("#sliderSection").removeClass("hidden")});{$("#roi-repport-download").on("click",function(a){a.preventDefault(),$("#second-progress-dot").addClass("show-icon"),$("#second-done-icon").addClass("show"),$("#progres-line").addClass("completed-line"),$("#third-progress-dot").removeClass("disabled-progress-bar"),downloadPdf()}),document.getElementById("num-of-providers").reset(),document.getElementById("roi-calc-form").reset();{$("#Providers").on("input",()=>showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}));const b=()=>{let b=calculatePhoneTagCost(outbound_calls_per_day,calls_connected,time_per_call,hourly_wage_calling);!1===b?$("#costOfPhone").text("NA"):(b=a(b),phone_tag_cost=b,$("#costOfPhone").html("$"+nftd.format(b)),$("#result-div1").removeClass("border-grey-500"),c(),$("#card-result-1").removeClass("hidden"),0!==outbound_calls_per_day||0!==calls_connected?$("#clear-button-1").removeClass("disabled"):$("#clear-button-1").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))};$("#Calls-Make-Per-Day").on("input",function(){outbound_calls_per_day=getNum($(this),400),b()}),$("#Speaking-With-Patient").on("input",function(){calls_connected=getNum($(this),30)/100,b()}),$("#Avg-Time-Per-Call").on("input",function(){time_per_call=getNum($(this),3),b()}),$("#hourlyWage").on("input",function(){hourly_wage_calling=getNum($(this),3),b()}),$("#clear-button-1").on("click",function(){$("#Calls-Make-Per-Day").val("0"),$("#Speaking-With-Patient").val("0"),outbound_calls_per_day=calls_connected=0,b(),$(this).addClass("disabled"),c(),$("#card-result-1").addClass("hidden")});const d=()=>{let b=calculateAbandonedCallsCost(inbound_calls_per_day,calls_abandoned,percent_calls_scheduling,rev_per_appt);!1===b?$("#CostAbandoned").text("NA"):(b=a(b),abandoned_calls_cost=b,$("#CostAbandoned").html("$"+nftd.format(b)),$("#result-div2").removeClass("border-grey-500"),c(),$("#clear-button-2").removeClass("disaled"),$("#card-result-2").removeClass("hidden"),inbound_calls_per_day||calls_abandoned?$("#clear-button-2").removeClass("disabled"):$("#clear-button-2").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))};$("#Calls-Receive-Per-Day").on("input",function(){inbound_calls_per_day=getNum($(this),400),d()}),$("#Abandoned-Calls").on("input",function(){calls_abandoned=getNum($(this),10)/100,d()}),$("#Percentage-Scheduling").on("input",function(){percent_calls_scheduling=getNum($(this),35)/100,d()}),$("#revenue").on("input",function(){rev_per_appt=getNum($(this),150),d(),e()}),$("#clear-button-2").on("click",function(){$("#Abandoned-Calls").val("0"),$("#Calls-Receive-Per-Day").val("0"),inbound_calls_per_day=calls_abandoned=0,d(),$(this).addClass("disabled"),c(),$("#card-result-2").addClass("hidden")});const e=()=>{let b=calculateNoShowCost(appts_per_day,no_shows,rev_per_appt);!1===b?$("#costNoShows").text("NA"):(b=a(b),no_show_cost=b,$("#costNoShows").html("$"+nftd.format(b)),$("#result-div3").removeClass("border-grey-500"),c(),$("#clear-button-3").removeClass("disaled"),$("#card-result-3").removeClass("hidden"),appts_per_day||no_shows?$("#clear-button-3").removeClass("disabled"):$("#clear-button-3").addClass("disabled"),showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost}))};$("#Patients-Seen-Each-Day").on("input",function(){appts_per_day=getNum($(this),200),e()}),$("#No-Shows").on("input",function(){no_shows=getNum($(this),20)/100,e()}),$("#clear-button-3").on("click",function(){$("#Patients-Seen-Each-Day").val("0"),$("#No-Shows").val("0"),appts_per_day=no_shows=0,e(),$(this).addClass("disabled"),c(),$("#card-result-3").addClass("hidden")})}}$("#phoneTag").on("input",function(){percent_phone_tag_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#abandonedCalls").on("input",function(){percent_abandoned_calls_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#noShows").on("input",function(){percent_no_show_savings=getNum($(this),75)/100,showTotalSavings({phone_tag_cost,abandoned_calls_cost,no_show_cost})}),$("#savingsButton").on("click",function(){$("#charts-section").removeClass("hidden"),$("#roi-footer").removeClass("hidden"),$("#first-progress-dot").addClass("show-icon"),$("#first-done-icon").addClass("show"),$("#progres-line").addClass("half-full"),$("#second-progress-dot").removeClass("disabled-progress-bar")});{const a=new URL(document.URL),b=a.search&&a.search.substring(1);if(b){const a=new URLSearchParams(b),c=a.get("providers");$("#Providers").val(c),$("#Providers").trigger("input"),setTimeout(()=>$("#calculate-roi")[0].click(),1500)}}});